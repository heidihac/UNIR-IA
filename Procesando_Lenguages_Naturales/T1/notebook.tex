
% Default to the notebook output style

    


% Inherit from the specified cell style.




    
\documentclass[11pt]{article}

    
    
    \usepackage[T1]{fontenc}
    % Nicer default font (+ math font) than Computer Modern for most use cases
    \usepackage{mathpazo}

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % We will generate all images so they have a width \maxwidth. This means
    % that they will get their normal width if they fit onto the page, but
    % are scaled down if they would overflow the margins.
    \makeatletter
    \def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
    \else\Gin@nat@width\fi}
    \makeatother
    \let\Oldincludegraphics\includegraphics
    % Set max figure width to be 80% of text width, for now hardcoded.
    \renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=.8\maxwidth]{#1}}
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionLabelFormat{nolabel}{}
    \captionsetup{labelformat=nolabel}

    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    

    
    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatability definitions
    \def\gt{>}
    \def\lt{<}
    % Document parameters
    \title{Task 1}
    
    
    

    % Pygments definitions
    
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % Exact colors from NB
    \definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
    \definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}



    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \maketitle
    
    

    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}1}]:} \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
        \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
        \PY{k+kn}{import} \PY{n+nn}{networkx} \PY{k}{as} \PY{n+nn}{nx}
\end{Verbatim}


    \hypertarget{load-and-clean-corpus}{%
\section{Load and Clean corpus}\label{load-and-clean-corpus}}

Load the corpus and introduce two additional states * \textless{} S
\textgreater{} \ldots{} the beginning of a setence * \textless{} E
\textgreater{} \ldots{} the end of a setence

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}184}]:} \PY{k}{with} \PY{n+nb}{open}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{corpus.txt}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{k}{as} \PY{n}{f}\PY{p}{:}
              \PY{n}{corpus\PYZus{}raw} \PY{o}{=} \PY{n}{f}\PY{o}{.}\PY{n}{readlines}\PY{p}{(}\PY{p}{)}
              
          \PY{n}{corpus\PYZus{}clean} \PY{o}{=} \PY{p}{[}\PY{p}{]}
          \PY{k}{for} \PY{n}{l} \PY{o+ow}{in} \PY{n}{corpus\PYZus{}raw}\PY{p}{:}
              \PY{c+c1}{\PYZsh{} Remove newline symbole}
              \PY{k}{if} \PY{n}{l}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
                  \PY{n}{l} \PY{o}{=} \PY{n}{l}\PY{p}{[}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
          
              \PY{c+c1}{\PYZsh{} Remove empty lines}
              \PY{k}{if} \PY{n}{l} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
                  \PY{k}{continue}
              
              \PY{c+c1}{\PYZsh{} Remove end of line}
              \PY{k}{if} \PY{n}{l}\PY{o}{.}\PY{n}{startswith}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZlt{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{:}
                  \PY{k}{continue}
          
              \PY{n}{corpus\PYZus{}clean}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{l}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{p}{)}\PY{p}{)}
              
              \PY{c+c1}{\PYZsh{} Add artifical setence end and start after .}
              \PY{k}{if} \PY{n}{l} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{. . Fp 0}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
                  \PY{n}{corpus\PYZus{}clean}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZlt{}E\PYZgt{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZlt{}E\PYZgt{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZlt{}E\PYZgt{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
                  \PY{n}{corpus\PYZus{}clean}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZlt{}S\PYZgt{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZlt{}S\PYZgt{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZlt{}S\PYZgt{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} Add a artificial start at the beginning, and remove last element}
          \PY{n}{corpus\PYZus{}clean}\PY{o}{.}\PY{n}{insert}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZlt{}S\PYZgt{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZlt{}S\PYZgt{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZlt{}S\PYZgt{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
          \PY{n}{corpus\PYZus{}clean}\PY{o}{.}\PY{n}{pop}\PY{p}{(}\PY{p}{)}
          \PY{n}{corpus\PYZus{}clean}\PY{o}{.}\PY{n}{pop}\PY{p}{(}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} Convert the corpus into an pandas dataframe}
          \PY{n}{corpus} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{data}\PY{o}{=}\PY{n}{corpus\PYZus{}clean}\PY{p}{,} \PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{token}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lema}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tag}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{content}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
              
          \PY{n}{corpus}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{15}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}184}]:}             token          lema      tag   content
          0             <S>           <S>      <S>         0
          1        Tristana      tristana  NP00000         0
          2              es           ser  VSIP3S0  01775973
          3             una           uno   DI0FS0         0
          4        película      película  NCFS000  04960631
          5              de            de    SPS00         0
          6              el            el   DA0MS0         0
          7        director      director  NCMS000  07063762
          8         español       español   AQ0MS0  02727705
          9   nacionalizado  nacionalizar  VMP00SM  00285796
          10       mexicano      mexicano   AQ0MS0  02782661
          11    Luis\_Buñuel   luis\_buñuel  NP00000         0
          12              .             .       Fp         0
          13            <E>           <E>      <E>         0
          14            <S>           <S>      <S>         0
\end{Verbatim}
            
    \hypertarget{transition-probabilities}{%
\section{Transition Probabilities}\label{transition-probabilities}}

Use the corpus to calculate transition probabilities between POS tags

It is read from \textbf{row} -\textgreater{} \textbf{column}

e.g.

S -\textgreater{} SPS00 = 0.4 \ldots{} means after the setence start
there is a chance of 40\% that the next tag is a SPS00

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}210}]:} \PY{c+c1}{\PYZsh{} Build table to transition probabilities}
          \PY{n}{tags} \PY{o}{=} \PY{n}{corpus}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tag}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{utags} \PY{o}{=} \PY{n}{tags}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} Generate empty table}
          \PY{n}{tp} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{n}{utags}\PY{p}{,} \PY{n}{index}\PY{o}{=}\PY{n}{utags}\PY{p}{,} \PY{n}{data}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} Add transition frequencies}
          \PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{j} \PY{o+ow}{in} \PY{n+nb}{zip}\PY{p}{(}\PY{n}{tags}\PY{p}{[}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{tags}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{:}\PY{p}{]}\PY{p}{)}\PY{p}{:}
              \PY{n}{tp}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{i}\PY{p}{,} \PY{n}{j}\PY{p}{]} \PY{o}{=} \PY{n}{tp}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{i}\PY{p}{,} \PY{n}{j}\PY{p}{]} \PY{o}{+} \PY{l+m+mi}{1}
          
          \PY{n}{tp}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}210}]:}          <S>  NP00000  VSIP3S0  DI0FS0  NCFS000  SPS00  DA0MS0  NCMS000  AQ0MS0  VMP00SM  Fp  <E>  VAIP3S0  VMP00SF  DA0FS0  VSIS3S0  AQ0CS0  RN  AQ0FS0  Z  DP3CS0  AO0MS0  CC  VMIP3S0  CS  VSSP1S0  DI0MS0  Fc  VSN0000  PR0CN000  VMN0000  NCMN000  PI0CS000  NCFP000  DD0MS0  NCCS000  Fpa  Fpt  PR0CP000  PP3CSD00  RG  VMIC1S0  DI0FP0  PP3CNA00  Fe  P0000000  PR0CS000  DA0MP0  NCMP000  DA0NS0  \textbackslash{}
          <S>        0        3        0       0        0      6       0        0       0        0   0    0        1        0       0        1       0   0       0  0       0       0   0        1   1        0       0   0        0         0        0        0         0        0       0        0    0    0         0         0   3        0       0         0   0         0         0       0        0       0   
          NP00000    0        0        1       0        0      3       0        0       0        0   4    0        0        0       0        0       0   0       0  0       0       0   2        7   0        0       0   6        0         0        0        0         0        0       0        0    2    3         0         1   0        1       0         0   1         0         0       0        0       0   
          VSIP3S0    0        0        0       1        0      0       0        0       0        1   0    0        0        0       0        0       0   0       0  0       0       0   0        0   0        0       0   0        0         0        0        0         0        0       0        0    0    0         0         0   1        0       0         0   0         0         0       0        0       0   
          DI0FS0     0        0        0       0        3      0       0        0       0        0   0    0        0        0       0        0       1   0       0  0       0       0   0        0   0        0       0   0        0         0        0        0         0        0       0        0    0    0         0         0   0        0       0         0   0         0         0       0        0       0   
          NCFS000    0        0        0       0        0      6       0        0       0        0   1    0        0        0       0        0       1   1       1  0       0       0   1        0   0        0       0   1        0         1        0        0         0        0       0        0    0    0         0         0   0        0       0         1   1         1         0       0        0       0   
          
                   VMIP3P0  VMIS3S0  VMII1S0  PI0MS000  Zu  VMSP1S0  Fx  PP3MS000  VMSI1S0  VAII1S0  DP3CP0  NCCP000  VMG0000  PP3MPA00  DD0CP0  VMP00PM  DI0MP0  AQ0MP0  VSII1S0  VMII3P0  
          <S>            0        0        0         0   0        0   0         0        0        0       0        0        0         0       0        0       0       0        0        0  
          NP00000        0        0        0         0   0        0   0         0        0        1       0        0        0         0       0        0       0       0        0        0  
          VSIP3S0        0        0        0         0   0        0   0         0        0        0       0        0        0         0       0        0       0       0        0        0  
          DI0FS0         0        0        0         0   0        0   0         0        0        0       0        0        0         0       0        0       0       0        0        0  
          NCFS000        0        0        0         0   0        0   0         0        0        0       0        0        0         0       0        0       0       0        0        0  
\end{Verbatim}
            
    \hypertarget{normalized-transition-probability-matrix}{%
\subsubsection{Normalized transition probability
matrix}\label{normalized-transition-probability-matrix}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}211}]:} \PY{c+c1}{\PYZsh{} Normalize row wise}
          \PY{n}{ntp} \PY{o}{=} \PY{n}{tp}\PY{o}{.}\PY{n}{div}\PY{p}{(}\PY{n}{tp}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
          \PY{n}{ntp}\PY{o}{.}\PY{n}{to\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{transition\PYZus{}probabilities.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} Remove the Transitions from end to start \PYZlt{}E\PYZgt{} \PYZhy{}\PYZgt{} \PYZlt{}S\PYZgt{}}
          \PY{n}{ntp}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZlt{}E\PYZgt{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZlt{}S\PYZgt{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{l+m+mf}{0.0}
          
          \PY{n}{ntp}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}211}]:}          <S>  NP00000  VSIP3S0    DI0FS0  NCFS000    SPS00  DA0MS0  NCMS000  AQ0MS0   VMP00SM      Fp  <E>   VAIP3S0  VMP00SF  DA0FS0   VSIS3S0  AQ0CS0      RN  AQ0FS0    Z  DP3CS0  AO0MS0      CC   VMIP3S0        CS  VSSP1S0  DI0MS0      Fc  VSN0000  PR0CN000  VMN0000  NCMN000  PI0CS000  NCFP000  DD0MS0  NCCS000     Fpa      Fpt  PR0CP000  PP3CSD00        RG  VMIC1S0  DI0FP0  PP3CNA00       Fe  \textbackslash{}
          <S>      0.0      0.2  0.00000  0.000000     0.00  0.40000     0.0      0.0     0.0  0.000000  0.0000  0.0  0.066667      0.0     0.0  0.066667  0.0000  0.0000  0.0000  0.0     0.0     0.0  0.0000  0.066667  0.066667      0.0     0.0  0.0000      0.0    0.0000      0.0      0.0       0.0      0.0     0.0      0.0  0.0000  0.00000       0.0   0.00000  0.200000  0.00000     0.0    0.0000  0.00000   
          NP00000  0.0      0.0  0.03125  0.000000     0.00  0.09375     0.0      0.0     0.0  0.000000  0.1250  0.0  0.000000      0.0     0.0  0.000000  0.0000  0.0000  0.0000  0.0     0.0     0.0  0.0625  0.218750  0.000000      0.0     0.0  0.1875      0.0    0.0000      0.0      0.0       0.0      0.0     0.0      0.0  0.0625  0.09375       0.0   0.03125  0.000000  0.03125     0.0    0.0000  0.03125   
          VSIP3S0  0.0      0.0  0.00000  0.333333     0.00  0.00000     0.0      0.0     0.0  0.333333  0.0000  0.0  0.000000      0.0     0.0  0.000000  0.0000  0.0000  0.0000  0.0     0.0     0.0  0.0000  0.000000  0.000000      0.0     0.0  0.0000      0.0    0.0000      0.0      0.0       0.0      0.0     0.0      0.0  0.0000  0.00000       0.0   0.00000  0.333333  0.00000     0.0    0.0000  0.00000   
          DI0FS0   0.0      0.0  0.00000  0.000000     0.75  0.00000     0.0      0.0     0.0  0.000000  0.0000  0.0  0.000000      0.0     0.0  0.000000  0.2500  0.0000  0.0000  0.0     0.0     0.0  0.0000  0.000000  0.000000      0.0     0.0  0.0000      0.0    0.0000      0.0      0.0       0.0      0.0     0.0      0.0  0.0000  0.00000       0.0   0.00000  0.000000  0.00000     0.0    0.0000  0.00000   
          NCFS000  0.0      0.0  0.00000  0.000000     0.00  0.37500     0.0      0.0     0.0  0.000000  0.0625  0.0  0.000000      0.0     0.0  0.000000  0.0625  0.0625  0.0625  0.0     0.0     0.0  0.0625  0.000000  0.000000      0.0     0.0  0.0625      0.0    0.0625      0.0      0.0       0.0      0.0     0.0      0.0  0.0000  0.00000       0.0   0.00000  0.000000  0.00000     0.0    0.0625  0.06250   
          
                   P0000000  PR0CS000  DA0MP0  NCMP000  DA0NS0  VMIP3P0  VMIS3S0  VMII1S0  PI0MS000   Zu  VMSP1S0   Fx  PP3MS000  VMSI1S0  VAII1S0  DP3CP0  NCCP000  VMG0000  PP3MPA00  DD0CP0  VMP00PM  DI0MP0  AQ0MP0  VSII1S0  VMII3P0  
          <S>        0.0000       0.0     0.0      0.0     0.0      0.0      0.0      0.0       0.0  0.0      0.0  0.0       0.0      0.0  0.00000     0.0      0.0      0.0       0.0     0.0      0.0     0.0     0.0      0.0      0.0  
          NP00000    0.0000       0.0     0.0      0.0     0.0      0.0      0.0      0.0       0.0  0.0      0.0  0.0       0.0      0.0  0.03125     0.0      0.0      0.0       0.0     0.0      0.0     0.0     0.0      0.0      0.0  
          VSIP3S0    0.0000       0.0     0.0      0.0     0.0      0.0      0.0      0.0       0.0  0.0      0.0  0.0       0.0      0.0  0.00000     0.0      0.0      0.0       0.0     0.0      0.0     0.0     0.0      0.0      0.0  
          DI0FS0     0.0000       0.0     0.0      0.0     0.0      0.0      0.0      0.0       0.0  0.0      0.0  0.0       0.0      0.0  0.00000     0.0      0.0      0.0       0.0     0.0      0.0     0.0     0.0      0.0      0.0  
          NCFS000    0.0625       0.0     0.0      0.0     0.0      0.0      0.0      0.0       0.0  0.0      0.0  0.0       0.0      0.0  0.00000     0.0      0.0      0.0       0.0     0.0      0.0     0.0     0.0      0.0      0.0  
\end{Verbatim}
            
    \hypertarget{emition-probabilities}{%
\section{Emition Probabilities}\label{emition-probabilities}}

Generate a table containing the probability that a given token coaccuras
with a given word.

This is read from columns -\textgreater{} rows:

VSIP3S0 -\textgreater{} es : given VSIP3S0 100\% of words are `es'

NCPFS00 -\textgreater{} película : given NCPFS00, 12.5\% of words are
`película'

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}212}]:} \PY{n}{unique\PYZus{}tokens} \PY{o}{=} \PY{n}{corpus}\PY{o}{.}\PY{n}{token}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} Create empty emission probability matrix}
          \PY{n}{ePM} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{index}\PY{o}{=}\PY{n}{unique\PYZus{}tokens}\PY{p}{,} \PY{n}{columns}\PY{o}{=}\PY{n}{utags}\PY{p}{,} \PY{n}{data}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} Fill emission probability matrix}
          \PY{k}{for} \PY{n}{token} \PY{o+ow}{in} \PY{n}{unique\PYZus{}tokens}\PY{p}{:}
              \PY{n}{tags} \PY{o}{=} \PY{n}{corpus}\PY{p}{[}\PY{n}{corpus}\PY{o}{.}\PY{n}{token} \PY{o}{==} \PY{n}{token}\PY{p}{]}\PY{o}{.}\PY{n}{tag}\PY{o}{.}\PY{n}{value\PYZus{}counts}\PY{p}{(}\PY{p}{)}
              \PY{k}{for} \PY{n}{tag}\PY{p}{,} \PY{n}{n} \PY{o+ow}{in} \PY{n}{tags}\PY{o}{.}\PY{n}{iteritems}\PY{p}{(}\PY{p}{)}\PY{p}{:}
                  \PY{n}{ePM}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{token}\PY{p}{,} \PY{n}{tag}\PY{p}{]} \PY{o}{=} \PY{n}{n}
                  
          \PY{c+c1}{\PYZsh{} Normalize the matrix column wise}
          \PY{n}{nePM} \PY{o}{=} \PY{n}{ePM}\PY{o}{.}\PY{n}{div}\PY{p}{(}\PY{n}{ePM}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}213}]:} \PY{n}{ePM}\PY{o}{.}\PY{n}{to\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{emission\PYZus{}frequencies.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{nePM}\PY{o}{.}\PY{n}{to\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{emission\PYZus{}probabilities.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{nePM}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{15}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}213}]:}                <S>  NP00000  VSIP3S0  DI0FS0  NCFS000     SPS00  DA0MS0   NCMS000    AQ0MS0   VMP00SM   Fp  <E>  VAIP3S0  VMP00SF  DA0FS0  VSIS3S0  AQ0CS0   RN  AQ0FS0    Z  DP3CS0  AO0MS0   CC  VMIP3S0   CS  VSSP1S0  DI0MS0   Fc  VSN0000  PR0CN000  VMN0000  NCMN000  PI0CS000  NCFP000  DD0MS0  NCCS000  Fpa  Fpt  PR0CP000  PP3CSD00   RG  VMIC1S0  DI0FP0  PP3CNA00   Fe  P0000000  PR0CS000  DA0MP0  \textbackslash{}
          <S>            1.0  0.00000      0.0     0.0    0.000  0.000000     0.0  0.000000  0.000000  0.000000  0.0  0.0      0.0      0.0     0.0      0.0     0.0  0.0     0.0  0.0     0.0     0.0  0.0      0.0  0.0      0.0     0.0  0.0      0.0       0.0      0.0      0.0       0.0      0.0     0.0      0.0  0.0  0.0       0.0       0.0  0.0      0.0     0.0       0.0  0.0       0.0       0.0     0.0   
          Tristana       0.0  0.03125      0.0     0.0    0.000  0.000000     0.0  0.000000  0.000000  0.000000  0.0  0.0      0.0      0.0     0.0      0.0     0.0  0.0     0.0  0.0     0.0     0.0  0.0      0.0  0.0      0.0     0.0  0.0      0.0       0.0      0.0      0.0       0.0      0.0     0.0      0.0  0.0  0.0       0.0       0.0  0.0      0.0     0.0       0.0  0.0       0.0       0.0     0.0   
          es             0.0  0.00000      1.0     0.0    0.000  0.000000     0.0  0.000000  0.000000  0.000000  0.0  0.0      0.0      0.0     0.0      0.0     0.0  0.0     0.0  0.0     0.0     0.0  0.0      0.0  0.0      0.0     0.0  0.0      0.0       0.0      0.0      0.0       0.0      0.0     0.0      0.0  0.0  0.0       0.0       0.0  0.0      0.0     0.0       0.0  0.0       0.0       0.0     0.0   
          una            0.0  0.00000      0.0     1.0    0.000  0.000000     0.0  0.000000  0.000000  0.000000  0.0  0.0      0.0      0.0     0.0      0.0     0.0  0.0     0.0  0.0     0.0     0.0  0.0      0.0  0.0      0.0     0.0  0.0      0.0       0.0      0.0      0.0       0.0      0.0     0.0      0.0  0.0  0.0       0.0       0.0  0.0      0.0     0.0       0.0  0.0       0.0       0.0     0.0   
          película       0.0  0.00000      0.0     0.0    0.125  0.000000     0.0  0.000000  0.000000  0.000000  0.0  0.0      0.0      0.0     0.0      0.0     0.0  0.0     0.0  0.0     0.0     0.0  0.0      0.0  0.0      0.0     0.0  0.0      0.0       0.0      0.0      0.0       0.0      0.0     0.0      0.0  0.0  0.0       0.0       0.0  0.0      0.0     0.0       0.0  0.0       0.0       0.0     0.0   
          de             0.0  0.00000      0.0     0.0    0.000  0.367647     0.0  0.000000  0.000000  0.000000  0.0  0.0      0.0      0.0     0.0      0.0     0.0  0.0     0.0  0.0     0.0     0.0  0.0      0.0  0.0      0.0     0.0  0.0      0.0       0.0      0.0      0.0       0.0      0.0     0.0      0.0  0.0  0.0       0.0       0.0  0.0      0.0     0.0       0.0  0.0       0.0       0.0     0.0   
          el             0.0  0.00000      0.0     0.0    0.000  0.000000     1.0  0.000000  0.000000  0.000000  0.0  0.0      0.0      0.0     0.0      0.0     0.0  0.0     0.0  0.0     0.0     0.0  0.0      0.0  0.0      0.0     0.0  0.0      0.0       0.0      0.0      0.0       0.0      0.0     0.0      0.0  0.0  0.0       0.0       0.0  0.0      0.0     0.0       0.0  0.0       0.0       0.0     0.0   
          director       0.0  0.00000      0.0     0.0    0.000  0.000000     0.0  0.027027  0.000000  0.000000  0.0  0.0      0.0      0.0     0.0      0.0     0.0  0.0     0.0  0.0     0.0     0.0  0.0      0.0  0.0      0.0     0.0  0.0      0.0       0.0      0.0      0.0       0.0      0.0     0.0      0.0  0.0  0.0       0.0       0.0  0.0      0.0     0.0       0.0  0.0       0.0       0.0     0.0   
          español        0.0  0.00000      0.0     0.0    0.000  0.000000     0.0  0.000000  0.142857  0.000000  0.0  0.0      0.0      0.0     0.0      0.0     0.0  0.0     0.0  0.0     0.0     0.0  0.0      0.0  0.0      0.0     0.0  0.0      0.0       0.0      0.0      0.0       0.0      0.0     0.0      0.0  0.0  0.0       0.0       0.0  0.0      0.0     0.0       0.0  0.0       0.0       0.0     0.0   
          nacionalizado  0.0  0.00000      0.0     0.0    0.000  0.000000     0.0  0.000000  0.000000  0.111111  0.0  0.0      0.0      0.0     0.0      0.0     0.0  0.0     0.0  0.0     0.0     0.0  0.0      0.0  0.0      0.0     0.0  0.0      0.0       0.0      0.0      0.0       0.0      0.0     0.0      0.0  0.0  0.0       0.0       0.0  0.0      0.0     0.0       0.0  0.0       0.0       0.0     0.0   
          mexicano       0.0  0.00000      0.0     0.0    0.000  0.000000     0.0  0.000000  0.142857  0.000000  0.0  0.0      0.0      0.0     0.0      0.0     0.0  0.0     0.0  0.0     0.0     0.0  0.0      0.0  0.0      0.0     0.0  0.0      0.0       0.0      0.0      0.0       0.0      0.0     0.0      0.0  0.0  0.0       0.0       0.0  0.0      0.0     0.0       0.0  0.0       0.0       0.0     0.0   
          Luis\_Buñuel    0.0  0.03125      0.0     0.0    0.000  0.000000     0.0  0.000000  0.000000  0.000000  0.0  0.0      0.0      0.0     0.0      0.0     0.0  0.0     0.0  0.0     0.0     0.0  0.0      0.0  0.0      0.0     0.0  0.0      0.0       0.0      0.0      0.0       0.0      0.0     0.0      0.0  0.0  0.0       0.0       0.0  0.0      0.0     0.0       0.0  0.0       0.0       0.0     0.0   
          .              0.0  0.00000      0.0     0.0    0.000  0.000000     0.0  0.000000  0.000000  0.000000  1.0  0.0      0.0      0.0     0.0      0.0     0.0  0.0     0.0  0.0     0.0     0.0  0.0      0.0  0.0      0.0     0.0  0.0      0.0       0.0      0.0      0.0       0.0      0.0     0.0      0.0  0.0  0.0       0.0       0.0  0.0      0.0     0.0       0.0  0.0       0.0       0.0     0.0   
          <E>            0.0  0.00000      0.0     0.0    0.000  0.000000     0.0  0.000000  0.000000  0.000000  0.0  1.0      0.0      0.0     0.0      0.0     0.0  0.0     0.0  0.0     0.0     0.0  0.0      0.0  0.0      0.0     0.0  0.0      0.0       0.0      0.0      0.0       0.0      0.0     0.0      0.0  0.0  0.0       0.0       0.0  0.0      0.0     0.0       0.0  0.0       0.0       0.0     0.0   
          Está           0.0  0.00000      0.0     0.0    0.000  0.000000     0.0  0.000000  0.000000  0.000000  0.0  0.0      0.5      0.0     0.0      0.0     0.0  0.0     0.0  0.0     0.0     0.0  0.0      0.0  0.0      0.0     0.0  0.0      0.0       0.0      0.0      0.0       0.0      0.0     0.0      0.0  0.0  0.0       0.0       0.0  0.0      0.0     0.0       0.0  0.0       0.0       0.0     0.0   
          
                         NCMP000  DA0NS0  VMIP3P0  VMIS3S0  VMII1S0  PI0MS000   Zu  VMSP1S0   Fx  PP3MS000  VMSI1S0  VAII1S0  DP3CP0  NCCP000  VMG0000  PP3MPA00  DD0CP0  VMP00PM  DI0MP0  AQ0MP0  VSII1S0  VMII3P0  
          <S>                0.0     0.0      0.0      0.0      0.0       0.0  0.0      0.0  0.0       0.0      0.0      0.0     0.0      0.0      0.0       0.0     0.0      0.0     0.0     0.0      0.0      0.0  
          Tristana           0.0     0.0      0.0      0.0      0.0       0.0  0.0      0.0  0.0       0.0      0.0      0.0     0.0      0.0      0.0       0.0     0.0      0.0     0.0     0.0      0.0      0.0  
          es                 0.0     0.0      0.0      0.0      0.0       0.0  0.0      0.0  0.0       0.0      0.0      0.0     0.0      0.0      0.0       0.0     0.0      0.0     0.0     0.0      0.0      0.0  
          una                0.0     0.0      0.0      0.0      0.0       0.0  0.0      0.0  0.0       0.0      0.0      0.0     0.0      0.0      0.0       0.0     0.0      0.0     0.0     0.0      0.0      0.0  
          película           0.0     0.0      0.0      0.0      0.0       0.0  0.0      0.0  0.0       0.0      0.0      0.0     0.0      0.0      0.0       0.0     0.0      0.0     0.0     0.0      0.0      0.0  
          de                 0.0     0.0      0.0      0.0      0.0       0.0  0.0      0.0  0.0       0.0      0.0      0.0     0.0      0.0      0.0       0.0     0.0      0.0     0.0     0.0      0.0      0.0  
          el                 0.0     0.0      0.0      0.0      0.0       0.0  0.0      0.0  0.0       0.0      0.0      0.0     0.0      0.0      0.0       0.0     0.0      0.0     0.0     0.0      0.0      0.0  
          director           0.0     0.0      0.0      0.0      0.0       0.0  0.0      0.0  0.0       0.0      0.0      0.0     0.0      0.0      0.0       0.0     0.0      0.0     0.0     0.0      0.0      0.0  
          español            0.0     0.0      0.0      0.0      0.0       0.0  0.0      0.0  0.0       0.0      0.0      0.0     0.0      0.0      0.0       0.0     0.0      0.0     0.0     0.0      0.0      0.0  
          nacionalizado      0.0     0.0      0.0      0.0      0.0       0.0  0.0      0.0  0.0       0.0      0.0      0.0     0.0      0.0      0.0       0.0     0.0      0.0     0.0     0.0      0.0      0.0  
          mexicano           0.0     0.0      0.0      0.0      0.0       0.0  0.0      0.0  0.0       0.0      0.0      0.0     0.0      0.0      0.0       0.0     0.0      0.0     0.0     0.0      0.0      0.0  
          Luis\_Buñuel        0.0     0.0      0.0      0.0      0.0       0.0  0.0      0.0  0.0       0.0      0.0      0.0     0.0      0.0      0.0       0.0     0.0      0.0     0.0     0.0      0.0      0.0  
          .                  0.0     0.0      0.0      0.0      0.0       0.0  0.0      0.0  0.0       0.0      0.0      0.0     0.0      0.0      0.0       0.0     0.0      0.0     0.0     0.0      0.0      0.0  
          <E>                0.0     0.0      0.0      0.0      0.0       0.0  0.0      0.0  0.0       0.0      0.0      0.0     0.0      0.0      0.0       0.0     0.0      0.0     0.0     0.0      0.0      0.0  
          Está               0.0     0.0      0.0      0.0      0.0       0.0  0.0      0.0  0.0       0.0      0.0      0.0     0.0      0.0      0.0       0.0     0.0      0.0     0.0     0.0      0.0      0.0  
\end{Verbatim}
            
    \hypertarget{pos-tag-sentence}{%
\section{POS Tag sentence}\label{pos-tag-sentence}}

Pos Tag the sentence

\textbf{Habla de trasplantes con el enfermo grave.}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}214}]:} \PY{c+c1}{\PYZsh{}sentence = \PYZsq{}Habla de trasplantes con el enfermo grave.\PYZsq{}.split()}
          
          \PY{c+c1}{\PYZsh{} Modify the sentence in order to fit corpus and nePM table}
          \PY{n}{sentence} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZlt{}S\PYZgt{} habla de trasplantes con el enfermo grave . \PYZlt{}E\PYZgt{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \hypertarget{simple-single-max-search}{%
\subsection{Simple single max search}\label{simple-single-max-search}}

Take the etiquete with the highest chance of corresponding to a word.
(not taking into accoutn any world order or transition probability
between etiquets)

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}215}]:} \PY{n}{pos\PYZus{}tags} \PY{o}{=} \PY{p}{[}\PY{n}{nePM}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{w}\PY{p}{]}\PY{o}{.}\PY{n}{idxmax}\PY{p}{(}\PY{p}{)} \PY{k}{for} \PY{n}{w} \PY{o+ow}{in} \PY{n}{sentence}\PY{p}{]}
              
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ }\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{sentence}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{Becomes ...}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          
          \PY{k}{for} \PY{n}{w}\PY{p}{,} \PY{n}{tag} \PY{o+ow}{in} \PY{n+nb}{zip}\PY{p}{(}\PY{n}{sentence}\PY{p}{,} \PY{n}{pos\PYZus{}tags}\PY{p}{)}\PY{p}{:}
              \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s1}{|}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s1}{ }\PY{l+s+s1}{\PYZsq{}}\PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{w}\PY{p}{,} \PY{n}{tag}\PY{p}{)}\PY{p}{,} \PY{n}{end}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
<S> habla de trasplantes con el enfermo grave . <E>

Becomes {\ldots}

<S>|<S> habla|VMIP3S0 de|SPS00 trasplantes|NCMP000 con|SPS00 el|DA0MS0 enfermo|AQ0MS0 grave|AQ0CS0 .|Fp <E>|<E> 
    \end{Verbatim}

    \hypertarget{viterbi-algoritm}{%
\subsection{Viterbi Algoritm}\label{viterbi-algoritm}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}216}]:} \PY{c+c1}{\PYZsh{} Apply a laplace correction for missing transitions and emittions}
          \PY{n}{nePM2} \PY{o}{=} \PY{n}{nePM} \PY{o}{+} \PY{l+m+mf}{0.0001}
          \PY{n}{ntp2} \PY{o}{=} \PY{n}{ntp} \PY{o}{+} \PY{l+m+mf}{0.0001}
          \PY{n}{table} \PY{o}{=} \PY{p}{[}\PY{p}{[}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{log}\PY{p}{(}\PY{l+m+mf}{1.0}\PY{p}{)}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZlt{}S\PYZgt{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{]}\PY{p}{,}\PY{p}{]}
          
          \PY{k}{for} \PY{n}{w} \PY{o+ow}{in} \PY{n}{sentence}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{:}\PY{p}{]}\PY{p}{:}
              \PY{n}{token\PYZus{}emp} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{log}\PY{p}{(}\PY{n}{nePM2}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{w}\PY{p}{]}\PY{p}{)}
              
              \PY{n}{prev\PYZus{}tags} \PY{o}{=} \PY{n}{table}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
              
              \PY{n}{next\PYZus{}table} \PY{o}{=} \PY{p}{[}\PY{p}{]}
              \PY{c+c1}{\PYZsh{} For each next tag, calculate its prop for the previous onces}
              \PY{k}{for} \PY{n}{next\PYZus{}tag} \PY{o+ow}{in} \PY{n}{token\PYZus{}emp}\PY{o}{.}\PY{n}{index}\PY{o}{.}\PY{n}{values}\PY{p}{:}
                  
                  \PY{n}{prev\PYZus{}table} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                  \PY{k}{for} \PY{n}{prev\PYZus{}tag\PYZus{}p}\PY{p}{,} \PY{n}{prev\PYZus{}tag}\PY{p}{,} \PY{n}{\PYZus{}} \PY{o+ow}{in} \PY{n}{prev\PYZus{}tags}\PY{p}{:}
                      \PY{c+c1}{\PYZsh{} transition prop}
                      \PY{n}{tp} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{log}\PY{p}{(}\PY{n}{ntp2}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{prev\PYZus{}tag}\PY{p}{,} \PY{n}{next\PYZus{}tag}\PY{p}{]}\PY{p}{)}
                      \PY{c+c1}{\PYZsh{} emission prop}
                      \PY{n}{ep} \PY{o}{=} \PY{n}{token\PYZus{}emp}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{next\PYZus{}tag}\PY{p}{]}
                  
                      \PY{n}{next\PYZus{}tag\PYZus{}p} \PY{o}{=} \PY{n}{tp} \PY{o}{+} \PY{n}{ep} \PY{o}{+} \PY{n}{prev\PYZus{}tag\PYZus{}p}
                      \PY{n}{prev\PYZus{}table}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{(}\PY{n}{next\PYZus{}tag\PYZus{}p}\PY{p}{,} \PY{n}{next\PYZus{}tag}\PY{p}{,} \PY{n}{prev\PYZus{}tag}\PY{p}{)}\PY{p}{)}
                  
                  \PY{n}{next\PYZus{}table}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n+nb}{max}\PY{p}{(}\PY{n}{prev\PYZus{}table}\PY{p}{)}\PY{p}{)}
              \PY{n}{table}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{next\PYZus{}table}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}217}]:} \PY{n}{pos\PYZus{}tags} \PY{o}{=} \PY{p}{[}\PY{p}{]}
          
          \PY{c+c1}{\PYZsh{} Start not from the last, but from the one before the last, because we cannot handle \PYZsq{}.\PYZsq{} correctly}
          \PY{n}{prev} \PY{o}{=} \PY{n+nb}{max}\PY{p}{(}\PY{n}{table}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
          
          \PY{k}{for} \PY{n}{current} \PY{o+ow}{in} \PY{n}{table}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{2}\PY{p}{:}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{:}
              \PY{n}{pos\PYZus{}tags}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{prev}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
              \PY{k}{for} \PY{n}{t} \PY{o+ow}{in} \PY{n}{current}\PY{p}{:}
                  \PY{k}{if} \PY{n}{t}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{==} \PY{n}{prev}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{:}
                      \PY{n}{prev} \PY{o}{=} \PY{n}{t}
                      \PY{k}{break}
          \PY{n}{pos\PYZus{}tags}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{prev}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}218}]:} \PY{k}{for} \PY{n}{w}\PY{p}{,} \PY{n}{tag} \PY{o+ow}{in} \PY{n+nb}{zip}\PY{p}{(}\PY{n}{sentence}\PY{p}{,} \PY{n}{pos\PYZus{}tags}\PY{p}{[}\PY{p}{:}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{:}
              \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s1}{|}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s1}{ }\PY{l+s+s1}{\PYZsq{}}\PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{w}\PY{p}{,} \PY{n}{tag}\PY{p}{)}\PY{p}{,} \PY{n}{end}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
<S>|<S> habla|VMIP3S0 de|SPS00 trasplantes|NCMP000 con|SPS00 el|DA0MS0 enfermo|NCMS000 grave|AQ0CS0 .|Fp <E>|<E> 
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}219}]:} \PY{n}{relevant\PYZus{}tp} \PY{o}{=} \PY{n}{ntp}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{pos\PYZus{}tags}\PY{p}{,} \PY{n}{pos\PYZus{}tags}\PY{p}{]}
          \PY{n}{relevant\PYZus{}tp}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}219}]:}             <E>        Fp    AQ0CS0   NCMS000    DA0MS0     SPS00   NCMP000     SPS00   VMIP3S0  <S>
          <E>      0.0000  0.000000  0.000000  0.000000  0.000000  0.000000  0.000000  0.000000  0.000000  0.0
          Fp       0.9375  0.000000  0.000000  0.000000  0.000000  0.000000  0.000000  0.000000  0.000000  0.0
          AQ0CS0   0.0000  0.000000  0.000000  0.176471  0.000000  0.176471  0.000000  0.176471  0.000000  0.0
          NCMS000  0.0000  0.054054  0.108108  0.000000  0.027027  0.378378  0.000000  0.378378  0.000000  0.0
          DA0MS0   0.0000  0.000000  0.040000  0.600000  0.000000  0.040000  0.000000  0.040000  0.000000  0.0
          SPS00    0.0000  0.000000  0.000000  0.044118  0.235294  0.000000  0.044118  0.000000  0.000000  0.0
          NCMP000  0.0000  0.125000  0.000000  0.000000  0.000000  0.125000  0.000000  0.125000  0.000000  0.0
          SPS00    0.0000  0.000000  0.000000  0.044118  0.235294  0.000000  0.044118  0.000000  0.000000  0.0
          VMIP3S0  0.0000  0.000000  0.000000  0.037037  0.037037  0.259259  0.000000  0.259259  0.037037  0.0
          <S>      0.0000  0.000000  0.000000  0.000000  0.000000  0.400000  0.000000  0.400000  0.066667  0.0
\end{Verbatim}
            
    \hypertarget{graph-of-transition-probabilitis}{%
\section{Graph of transition
probabilitis}\label{graph-of-transition-probabilitis}}

Generate a graph containing the transition probabilities of all tags
contained in the sentence

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}220}]:} \PY{n}{G} \PY{o}{=} \PY{n}{nx}\PY{o}{.}\PY{n}{DiGraph}\PY{p}{(}\PY{p}{)}
          \PY{p}{[}\PY{n}{G}\PY{o}{.}\PY{n}{add\PYZus{}node}\PY{p}{(}\PY{n}{node}\PY{p}{)} \PY{k}{for} \PY{n}{node} \PY{o+ow}{in} \PY{n}{relevant\PYZus{}tp}\PY{o}{.}\PY{n}{columns}\PY{p}{]}
          \PY{k}{for} \PY{n}{src} \PY{o+ow}{in} \PY{n}{relevant\PYZus{}tp}\PY{o}{.}\PY{n}{columns}\PY{p}{:}
              \PY{k}{for} \PY{n}{dest} \PY{o+ow}{in} \PY{n}{relevant\PYZus{}tp}\PY{o}{.}\PY{n}{columns}\PY{p}{:}
                  \PY{n}{w} \PY{o}{=} \PY{n}{ntp}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{src}\PY{p}{,} \PY{n}{dest}\PY{p}{]}
                  \PY{k}{if} \PY{n}{w} \PY{o}{\PYZgt{}} \PY{l+m+mf}{0.0}\PY{p}{:}
                      \PY{n}{G}\PY{o}{.}\PY{n}{add\PYZus{}edge}\PY{p}{(}\PY{n}{src}\PY{p}{,} \PY{n}{dest}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}1.2f}\PY{l+s+s1}{\PYZsq{}}\PY{o}{\PYZpc{}}\PY{k}{w})
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}221}]:} \PY{c+c1}{\PYZsh{} Write to disk and run dot \PYZhy{}Tpng transition\PYZus{}graph.dot \PYZgt{} transition\PYZus{}graph.png}
          \PY{n}{nx}\PY{o}{.}\PY{n}{nx\PYZus{}agraph}\PY{o}{.}\PY{n}{write\PYZus{}dot}\PY{p}{(}\PY{n}{G}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{transition\PYZus{}graph.dot}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}227}]:} \PY{n}{graph} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{imread}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{transition\PYZus{}graph.png}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{15}\PY{p}{,} \PY{l+m+mi}{15}\PY{p}{)}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n}{graph}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_22_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    

    % Add a bibliography block to the postdoc
    
    
    
    \end{document}
